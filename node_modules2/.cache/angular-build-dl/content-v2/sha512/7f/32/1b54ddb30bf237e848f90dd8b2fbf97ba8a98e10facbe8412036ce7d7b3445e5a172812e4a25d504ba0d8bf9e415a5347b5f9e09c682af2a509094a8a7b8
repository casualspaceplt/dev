(window.webpackJsonp=window.webpackJsonp||[]).push([[77],{vuQK:function(e,t,n){"use strict";n.r(t),n.d(t,"SearchPageModule",function(){return L});var i=n("tyNb"),o=n("mrSG"),r=n("TEn/"),s=n("XNiG"),c=n("VRyK"),a=n("NV1z"),l=n("R0Ic"),b=n("fXoL"),h=n("H+Hf"),u=n("qOnq"),d=n("ofXK"),p=n("4ro/"),f=n("xJkR"),g=n("kmqs"),m=n("sYmb");function w(e,t){1&e&&(b.Qb(0,"empty-view",11),b.gc(1,"translate")),2&e&&b.lc("text",b.hc(1,1,"ERROR_NETWORK"))}function v(e,t){1&e&&(b.Qb(0,"empty-view",11),b.gc(1,"translate")),2&e&&b.lc("text",b.hc(1,1,"EMPTY_PLACES"))}const O=function(){return{width:"100%",height:"200px","border-radius":"0"}};function y(e,t){1&e&&(b.Vb(0,"ion-col",12),b.Qb(1,"ngx-skeleton-loader",13),b.Ub()),2&e&&(b.Db(1),b.lc("theme",b.oc(1,O)))}function V(e,t){if(1&e&&(b.Vb(0,"ion-row"),b.Ec(1,y,2,2,"ion-col",10),b.Ub()),2&e){const e=b.fc();b.Db(1),b.lc("ngForOf",e.skeletonArray)}}const R=function(e){return[e]},E=function(e,t){return{location:e,unit:t}};function x(e,t){if(1&e&&(b.Vb(0,"ion-col",12),b.Qb(1,"app-place-card",14),b.Ub()),2&e){const e=t.$implicit,n=b.fc();b.Db(1),b.lc("routerLink",b.pc(4,R,"../places/"+e.id+"/"+e.slug))("place",e)("extraParams",b.qc(6,E,n.location,n.preference.unit))("customObservable",n.loadAndScroll)}}let T=(()=>{class e extends a.a{constructor(e,t,n){super(e),this.geolocationService=t,this.placeService=n,this.params={limit:100},this.places=[],this.skeletonArray=Array(12)}enableMenuSwipe(){return!1}ngOnInit(){this.setupObservables(),this.subscribeToQueryParams()}setupObservables(){this.contentLoaded=new s.a,this.loadAndScroll=Object(c.a)(this.container.ionScroll,this.contentLoaded)}subscribeToQueryParams(){this.activatedRoute.queryParams.subscribe(e=>{const t=e.q;t&&(this.searchTerm=t,this.params.tag=t.toLowerCase(),this.places=[],this.showLoadingView({showOverlay:!1}),this.loadData())})}onContentLoaded(){setTimeout(()=>{this.contentLoaded.next()},300)}ionViewDidEnter(){return Object(o.a)(this,void 0,void 0,function*(){const e=yield this.getTrans("SEARCH");this.setPageTitle(e),this.setMetaTags({title:e}),this.loadLocation()})}loadLocation(){return Object(o.a)(this,void 0,void 0,function*(){try{const e=yield this.geolocationService.getCurrentPosition();this.location=e}catch(e){console.warn(e)}})}loadData(e={}){return Object(o.a)(this,void 0,void 0,function*(){this.refresher=e.target;try{this.places=yield this.placeService.load(this.params),this.places.length?this.showContentView():this.showEmptyView(),this.onContentLoaded(),this.onRefreshComplete(this.places)}catch(t){this.translate.get("ERROR_NETWORK").subscribe(e=>this.showToast(e)),this.showContentView(),this.onRefreshComplete()}})}onSearch(e={}){this.navigateToRelative("./",{q:e.target.value})}}return e.\u0275fac=function(t){return new(t||e)(b.Pb(b.t),b.Pb(h.a),b.Pb(u.a))},e.\u0275cmp=b.Jb({type:e,selectors:[["page-search"]],viewQuery:function(e,t){if(1&e&&b.Kc(r.r,3),2&e){let e;b.tc(e=b.ec())&&(t.container=e.first)}},features:[b.Ab],decls:19,vars:15,consts:[["color","primary","fixed",""],["slot","start"],["inputmode","search","mode","ios",3,"value","placeholder","keyup.enter"],["scrollEvents","true",1,"ion-padding"],["container",""],["slot","fixed",3,"ionRefresh"],[3,"pullingText","refreshingText"],["icon","alert-circle-outline",3,"text",4,"ngIf"],["fixed",""],[4,"ngIf"],["size-xs","12","size-sm","6","size-md","6","size-lg","4",4,"ngFor","ngForOf"],["icon","alert-circle-outline",3,"text"],["size-xs","12","size-sm","6","size-md","6","size-lg","4"],["count","1","appearance","circle",3,"theme"],[3,"routerLink","place","extraParams","customObservable"]],template:function(e,t){1&e&&(b.Vb(0,"ion-header"),b.Vb(1,"ion-toolbar",0),b.Vb(2,"ion-buttons",1),b.Qb(3,"ion-back-button"),b.Ub(),b.Vb(4,"div"),b.Vb(5,"ion-searchbar",2),b.dc("keyup.enter",function(e){return t.onSearch(e)}),b.gc(6,"translate"),b.Ub(),b.Ub(),b.Ub(),b.Ub(),b.Vb(7,"ion-content",3,4),b.Vb(9,"ion-refresher",5),b.dc("ionRefresh",function(e){return t.loadData(e)}),b.Qb(10,"ion-refresher-content",6),b.gc(11,"translate"),b.gc(12,"translate"),b.Ub(),b.Ec(13,w,2,3,"empty-view",7),b.Ec(14,v,2,3,"empty-view",7),b.Vb(15,"ion-grid",8),b.Ec(16,V,2,1,"ion-row",9),b.Vb(17,"ion-row"),b.Ec(18,x,2,9,"ion-col",10),b.Ub(),b.Ub(),b.Ub()),2&e&&(b.Db(5),b.lc("value",t.searchTerm)("placeholder",b.hc(6,9,"SEARCH")),b.Db(5),b.mc("pullingText",b.hc(11,11,"PULL_TO_REFRESH")),b.mc("refreshingText",b.hc(12,13,"REFRESHING")),b.Db(3),b.lc("ngIf",t.isErrorViewVisible),b.Db(1),b.lc("ngIf",t.isEmptyViewVisible),b.Db(2),b.lc("ngIf",t.isLoadingViewVisible),b.Db(1),b.lc("@staggerIn",t.places.length),b.Db(1),b.lc("ngForOf",t.places))},directives:[r.w,r.db,r.l,r.h,r.i,r.P,r.nb,r.r,r.K,r.L,d.m,r.v,r.O,d.l,p.a,r.q,f.a,g.a,r.lb,i.i],pipes:[m.c],styles:["ion-content[_ngcontent-%COMP%]{--background:var(--ion-color-light-tint)}ion-searchbar[_ngcontent-%COMP%]{padding:0 8px!important}ion-buttons[_ngcontent-%COMP%]{align-self:center}"],data:{animation:[Object(l.l)("staggerIn",[Object(l.k)("* => *",[Object(l.f)(":enter",Object(l.j)({opacity:0,transform:"translate3d(0,10px,0)"}),{optional:!0}),Object(l.f)(":enter",Object(l.h)("100ms",[Object(l.e)("300ms",Object(l.j)({opacity:1,transform:"translate3d(0,0,0)"}))]),{optional:!0})])])]}}),e})();var P=n("d2mR");let L=(()=>{class e{}return e.\u0275mod=b.Nb({type:e}),e.\u0275inj=b.Mb({factory:function(t){return new(t||e)},imports:[[P.a,i.j.forChild([{path:"",component:T}])]]}),e})()}}]);