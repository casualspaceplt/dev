{"version":3,"file":"ion-bottom-drawer.js","sources":["ion-bottom-drawer/app/modules/ion-bottom-drawer/drawer-state.ts","ion-bottom-drawer/app/modules/ion-bottom-drawer/ion-bottom-drawer.ts","ion-bottom-drawer/app/modules/ion-bottom-drawer/ion-bottom-drawer.module.ts","ion-bottom-drawer/ion-bottom-drawer.ts"],"names":["Hammer.DIRECTION_VERTICAL","tslib_1.__decorate"],"mappings":"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","sourcesContent":["export enum DrawerState {\n  Bottom,\n  Docked,\n  Top\n}\n","import { Component, Input, ElementRef, Renderer2, Output, EventEmitter, AfterViewInit, OnChanges, SimpleChanges } from '@angular/core';\nimport { Platform, DomController } from '@ionic/angular';\nimport * as Hammer from 'hammerjs';\n\nimport { DrawerState } from './drawer-state';\n\n@Component({\n  selector: 'ion-bottom-drawer',\n  templateUrl: 'ion-bottom-drawer.html',\n  styleUrls: ['./ion-bottom-drawer.scss']\n})\nexport class IonBottomDrawerComponent implements AfterViewInit, OnChanges {\n  @Input() dockedHeight = 50;\n\n  @Input() shouldBounce = true;\n\n  @Input() disableDrag = false;\n\n  @Input() distanceTop = 0;\n\n  @Input() transition = '0.25s ease-in-out';\n\n  @Input() state: DrawerState = DrawerState.Bottom;\n\n  @Input() minimumHeight = 0;\n\n  @Output() stateChange: EventEmitter<DrawerState> = new EventEmitter<DrawerState>();\n\n  private _startPositionTop: number;\n  private readonly _BOUNCE_DELTA = 30;\n\n  constructor(\n    private _element: ElementRef,\n    private _renderer: Renderer2,\n    private _domCtrl: DomController,\n    private _platform: Platform\n  ) { }\n\n  ngAfterViewInit() {\n    this._renderer.setStyle(this._element.nativeElement.querySelector('.ion-bottom-drawer-scrollable-content :first-child'),\n      'touch-action', 'none');\n    this._setDrawerState(this.state);\n\n    const hammer = new Hammer(this._element.nativeElement);\n    hammer.get('pan').set({ enable: true, direction: Hammer.DIRECTION_VERTICAL });\n    hammer.on('pan panstart panend', (ev: any) => {\n      if (this.disableDrag) {\n        return;\n      }\n\n      switch (ev.type) {\n        case 'panstart':\n          this._handlePanStart();\n          break;\n        case 'panend':\n          this._handlePanEnd(ev);\n          break;\n        default:\n          this._handlePan(ev);\n      }\n    });\n  }\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (!changes.state) {\n      return;\n    }\n\n    this._setDrawerState(changes.state.currentValue);\n  }\n\n  private _setDrawerState(state: DrawerState) {\n    this._renderer.setStyle(this._element.nativeElement, 'transition', this.transition);\n    switch (state) {\n      case DrawerState.Bottom:\n        this._setTranslateY('calc(100vh - ' + this.minimumHeight + 'px)');\n        break;\n      case DrawerState.Docked:\n        this._setTranslateY((this._platform.height() - this.dockedHeight) + 'px');\n        break;\n      default:\n        this._setTranslateY(this.distanceTop + 'px');\n    }\n  }\n\n  private _handlePanStart() {\n    this._startPositionTop = this._element.nativeElement.getBoundingClientRect().top;\n  }\n\n  private _handlePanEnd(ev) {\n    if (this.shouldBounce && ev.isFinal) {\n      this._renderer.setStyle(this._element.nativeElement, 'transition', this.transition);\n\n      switch (this.state) {\n        case DrawerState.Docked:\n          this._handleDockedPanEnd(ev);\n          break;\n        case DrawerState.Top:\n          this._handleTopPanEnd(ev);\n          break;\n        default:\n          this._handleBottomPanEnd(ev);\n      }\n    }\n    this.stateChange.emit(this.state);\n  }\n\n  private _handleTopPanEnd(ev) {\n    if (ev.deltaY > this._BOUNCE_DELTA) {\n      this.state = DrawerState.Docked;\n    } else {\n      this._setTranslateY(this.distanceTop + 'px');\n    }\n  }\n\n  private _handleDockedPanEnd(ev) {\n    const absDeltaY = Math.abs(ev.deltaY);\n    if (absDeltaY > this._BOUNCE_DELTA && ev.deltaY < 0) {\n      this.state = DrawerState.Top;\n    } else if (absDeltaY > this._BOUNCE_DELTA && ev.deltaY > 0) {\n      this.state = DrawerState.Bottom;\n    } else {\n      this._setTranslateY((this._platform.height() - this.dockedHeight) + 'px');\n    }\n  }\n\n  private _handleBottomPanEnd(ev) {\n    if (-ev.deltaY > this._BOUNCE_DELTA) {\n      this.state = DrawerState.Docked;\n    } else {\n      this._setTranslateY('calc(100vh - ' + this.minimumHeight + 'px)');\n    }\n  }\n\n  private _handlePan(ev) {\n    const pointerY = ev.center.y;\n    this._renderer.setStyle(this._element.nativeElement, 'transition', 'none');\n    if (pointerY > 0 && pointerY < this._platform.height()) {\n      if (ev.additionalEvent === 'panup' || ev.additionalEvent === 'pandown') {\n        const newTop = this._startPositionTop + ev.deltaY;\n        if (newTop >= this.distanceTop) {\n          this._setTranslateY(newTop + 'px');\n        } else if (newTop < this.distanceTop) {\n          this._setTranslateY(this.distanceTop + 'px');\n        }\n        if (newTop > this._platform.height() - this.minimumHeight) {\n          this._setTranslateY((this._platform.height() - this.minimumHeight) + 'px');\n        }\n      }\n    }\n  }\n\n  private _setTranslateY(value) {\n    this._domCtrl.write(() => {\n      this._renderer.setStyle(this._element.nativeElement, 'transform', 'translateY(' + value + ')');\n    });\n  }\n}\n","import { NgModule } from '@angular/core';\nimport { IonicModule } from '@ionic/angular';\nimport { IonBottomDrawerComponent } from './ion-bottom-drawer';\n\n@NgModule({\n  declarations: [IonBottomDrawerComponent],\n  imports: [IonicModule],\n  exports: [IonBottomDrawerComponent]\n})\nexport class IonBottomDrawerModule { }\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './public_api';\n\nexport {IonBottomDrawerComponent as Éµa} from './app/modules/ion-bottom-drawer/ion-bottom-drawer';"]}